@{
    ViewBag.Title = "Index";
}

<h2>Data Sumber Daya Manusia Anak Perusahaan</h2>
<script type="text/javascript">

//    var companyId;
//    function onChange(e) {
//        var employeeGrid = $('#sdmAp').data('tGrid');
//        Console.log(employeeGrid);
//        companyId = e.value;

//        // rebind the related grid

//        employeeGrid.ajaxRequest();
//    }

//    function onDropDownListLoad(e) {
//        var employeeGrid = $('#sdmAp').data('tGrid');
//        companyId = -1;

//        // rebind the related grid
//        employeeGrid.ajaxRequest();
//    }

//    function onDataBinding(e) {
//        e.data = $.extend(e.data, { companyId: companyId });
//    }

    function loadGridUser(companyId) {
        $("#gridUser").load("/DataSdmAp/GridUser/" + companyId);
    }

    $(document).ready(function () {
        loadGridUser('@ViewBag.firstCompany');

        $("#companiesListItem").change(function () {
            loadGridUser($("#companiesListItem").val());
        });

//        var grid = $('#sdmAp').tGrid;
//        console.log($('#sdmAp'));
//        var originalUrl = grid.ajax.selectUrl;
//        grid.ajax.selectUrl = originalUrl + "&companyId=" + $("#companiesListItem").val();
//        grid.ajaxRequest();
    });
</script>

<div class="Asearch"><b>Anak Perusahaan</b></div><div class="titik2"> : </div><div class="Ainput">
@*@(Html.Telerik().DropDownList()
        .Name("id_ap")
        .ClientEvents(events => events
                .OnChange("onChange")
                    .OnLoad("onDropDownListLoad")
        )
        .BindTo(new SelectList(ViewBag.companies, "id", "nama"))
)
    <select name="id_ap" id="id_ap">
        <option value="">-- Pilih Anak Perusahaan --</option>
    </select>*@
        @Html.DropDownList("companiesListItem")
</div>
<br/>
<div id="gridUser"></div>